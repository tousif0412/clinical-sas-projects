/*******************************************************************
* Client:  xxxxxx                                                          
* Project:  yyyyyyy                                                   
* Program: lis9.SAS  
*
* Program Type: Listing
*
* Purpose: To produce 16.2.2.3 Serious Adverse Events 
* Usage Notes: 
*
*
* SASï¿½ Version: 9.2 [TS2M0]
* Operating System: Windows 2011           
*
* Author: Tousif Tamboli
* Date Created: 14-JUN-2025
* Modification History:
*******************************************************************/         
/* 1. GET ADAM DATASET INTO SAS */     
libname adam'/home/u63981529/CL/adam';

/* 2. KEEP REQUIRED VARIABLES AS PER MOCK SHELL*/

DATA ADAE;
   SET ADAM.ADAE;
   IF AESER EQ 'Y' ;
   spa=catx ("/",AETERM,AEBODSYS,AEDECOD);
   keep usubjid spa AESTDTC AEENDTC AESER AACN AREL AEOUT  ARELN ;            
RUN;

PROC SQL NOPRINT;
   SELECT COUNT (*) INTO: NBR FROM ADAE;
QUIT;
%PUT &NBR;

/* 4. Include RTF style macro */
%include "/home/u63981529/CL/TLF/macros/RTFSTYLE.sas";
%_RTFSTYLE_;

/* 5. Assign titles and footnotes */
title1 j=l 'COVID-19 AA';
title2 j=l 'Protocol: 043';
title3 j=c '16.2.2.3 Serious Adverse Events';

footnote1 j=l '/home/u63981529/CL/Program/tlf/LIS9.SAS';


options orientation=landscape;
ods escapechar='^';
ods rtf file='/home/u63981529/CL/TLF/output/Listing/L_16_2_2_3.rtf' style=styles.test;

/* 6. Generate the report using PROC REPORT */

proc report data=adae split='|' style= {outputwidth=100%};

   column usubjid spa AESTDTC AEENDTC AESER  AACN ARELN AREL AEOUT;

   define usubjid /order "Subject|Number"
   style (column) ={just=l cellwidth=15%}
   style (header) ={just=l cellwidth=15%};

   define spa /order "Adverse Event/Primary System Organ|Class/   Preffered term"
   style (column) ={just=l cellwidth=20%}
   style (header) ={just=l cellwidth=20%};


   define AESTDTC /display "Start|Date/Time"
   style (column) ={just=l cellwidth=10%}
   style (header) ={just=l cellwidth=10%};

   define AEENDTC /display "End |Date/Time"
   style (column) ={just=l cellwidth=10%}
   style (header) ={just=l cellwidth=10%};

   define AESER /display "Serious|Event"
   style (column) ={just=l cellwidth=6%}
   style (header) ={just=l cellwidth=6%};


   define AACN /display "Action taken"
   style (column) ={just=l cellwidth=8%}
   style (header) ={just=l cellwidth=8%};

   define ARELN/order noprint; 
   define AREL /display "Relationship|to|Study Drug"
   style (column) ={just=l cellwidth=10%}
   style (header) ={just=l cellwidth=10%};

   define AEOUT /display "Outcome"
   style (column) ={just=l cellwidth=10%}
   style (header) ={just=l cellwidth=10%};


   compute before _page_;
      line@1 "^{style [outputwidth=100% bordertopwidth=0.5pt]}";
   endcomp;

   compute after _page_;
      line@1 "^{style [outputwidth=100% bordertopwidth=0.5pt]}";
   endcomp;

run;

ods _all_ close;

